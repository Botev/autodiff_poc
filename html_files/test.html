<!DOCTYPE html>
<!-- saved from url=(0065)http://cpettitt.github.io/project/dagre-d3/latest/demo/hover.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8">
    <title>Function Graph</title>

    <link rel="stylesheet" href="../../html_files/demo.css">
    <script src="../../html_files/d3.v3.min.js" charset="utf-8"></script>
    <script src="../../html_files/dagre-d3.js"></script><style type="text/css"></style>

    <!-- Pull in JQuery dependencies -->
    <link rel="stylesheet" href="../../html_files/tipsy.css">
    <script src="../../html_files/jquery-1.9.1.min.js"></script>
    <script src="../../html_files/tipsy.js"></script>

</head><body style="margin:0;padding:0" height="100%"><h3 style="margin-bottom: 0px">mnist_hinton_copy</h3>
<h5 style="margin-top: 0px; margin-bottom: 0px">Default device: CPU[0]</h5>
<h5 style="margin-top: 0px; margin-bottom: 0px">Float type: f32</h5>
<h5 style="margin-top: 0px; margin-bottom: 0px">Integer type: s32</h5>
<h5 style="margin-top: 0px; margin-bottom: 0px">Broadcast policy: Quiet</h5>

<style id="css">
    text {
        font-weight: 300;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serf;
        font-size: 14px;
    }

    .node rect {
        stroke: #333;
        fill: #fff;
    }

    .edgePath path {
        stroke: #333;
        fill: #333;
        stroke-width: 1.5px;
    }

    .node text {
        pointer-events: none;
    }

    /* This styles the title of the tooltip */
    .tipsy .name {
        font-size: 1.5em;
        font-weight: bold;
        color: #60b1fc;
        margin: 0;
    }

    /* This styles the body of the tooltip */
    .tipsy .description {
        font-size: 1.2em;
    }
</style>

<svg width="1500" height="900"></svg>

<script id="js">
    var delimiter = "/";

    var PrimalNode = function(parent_group, name, node_info){
        this.parent_group = parent_group;
        this.name = name;
        this.node_info = node_info;
        this.child_groups = [];
        this.child_nodes = [];
        this.collapsed = false;
        this.hidden = false;
        this.display_node = undefined;
        if(name[0] == '_'){
            parent_group.child_groups.push(this);
        } else {
            parent_group.child_nodes.push(this);
        }

        this.getAllParentGroups = function (){
            var groups = [this.parent_group];
            while(groups[groups.length - 1].parent_group){
                groups.push(groups[groups.length - 1].parent_group);
            }
            return groups;
        }
    };

    function addGroup(graph, full_name){
        var names = full_name.split(delimiter);
        var node = g.node(names[0]);
        var name_acc = names[0];
        for (var i = 1; i < names.length; i++){
            name_acc += delimiter + names[i];
            if(name_acc in node.child_groups){
                node = node.child_groups[name_acc];
            } else {
                graph.setNode(name_acc, new PrimalNode(node, name_acc, undefined));
                node = graph.node(name_acc);
            }
        }
        return node;
    }

    function addNode (graph, group_name, name, node_info){
        var parent_group = graph.node(group_name);
        graph.setNode(name, new PrimalNode(parent_group, name, node_info));
        return graph.node(name);
    }

    function addEdge (graph, name_from, name_to, label){
        var from_groups = graph.node(name_from).getAllParentGroups();
        var to_groups = graph.node(name_to).getAllParentGroups();
        graph.setEdge(name_from, name_to, label);
        for(var i=0; i<from_groups.length; i++){
            var from_group = from_groups[i];
            if(! from_group in to_groups){
                for(var j=0; j<to_groups.length; j++){
                    var to_group = to_groups[j];
                    if(! to_group in from_groups){
                        graph.setEdge(from_group.name, to_group.name);
                    }
                }
            }
        }
    }


    var g_prime = new dagreD3.graphlib.Graph({compound:true, multigraph: true})
            .setGraph({})
            .setDefaultEdgeLabel(function() { return {}; });


    g_prime.setNode("_root", new PrimalNode(undefined, "_root", undefined));
    root_group = g_prime.node("_root");

    group1 = addGroup(g_prime, "_root/g1");
    group2 = addGroup(g_prime, "_root/g1/g2");
    group3 = addGroup(g_prime, "_root/g1/g3");

    node1 = addNode(g_prime, "_root", "n1", {});
    node2 = addNode(g_prime, "_root/g1", "n2", {});
    node3 = addNode(g_prime, "_root/g1/g2", "n3", {});
    node4 = addNode(g_prime, "_root/g1/g2", "n4", {});
    node5 = addNode(g_prime, "_root/g1/g3", "n5", {});
    node6 = addNode(g_prime, "_root/g1/g3", "n6", {});

    addEdge(g_prime, node1.name, node3.name);
    addEdge(g_prime, node2.name, node1.name);
    addEdge(g_prime, node3.name, node5.name);
    addEdge(g_prime, node3.name, node6.name);
    addEdge(g_prime, node5.name, node4.name);
    addEdge(g_prime, node6.name, node4.name);

    var g = g_prime;
    // Create the renderer
    var render = new dagreD3.render();

    // Set up an SVG group so that we can translate the final graph.
    var svg = d3.select("svg"),
            inner = svg.append("g");

    // Set up zoom support
    var zoom = d3.behavior.zoom().on("zoom", function() {
        inner.attr("transform", "translate(" + d3.event.translate + ")" +
                "scale(" + d3.event.scale + ")");
    });
    svg.call(zoom);

    // Simple function to style the tooltip for the given node.
    var styleTooltip = function(name, description) {
        return "<p class='name'>" + name + "</p><p class='description'  style=\"text-align:left\">" + description + "</p>";
    };

    // Run the renderer. This is what draws the final graph.
    render(inner, g);

    inner.selectAll("g.node")
            .attr("title", function(v) { return styleTooltip(v, g.node(v).description) })
            .each(function(v) { $(this).tipsy({ gravity: "w", opacity: 1, html: true }); });

    // Center the graph
    var initialScale = 0.75;
    zoom
            .translate([(svg.attr("width") - g.graph().width * initialScale) / 2, 20])
            .scale(initialScale)
            .event(svg);
    svg.attr('height', g.graph().height * initialScale + 40);
</script>
</body></html>
